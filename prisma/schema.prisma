generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String       @id @default(uuid())
  name        String       @unique
  password    String
  created_at  DateTime?    @default(now()) @db.Timestamptz(6)
  session     Session[]
  userDevices UserDevice[]
}

model UserDevice {
  id             String   @id @default(uuid())
  user_id        String
  name           String
  last_synced_at DateTime @db.Timestamptz(6)
  is_revoked     Boolean  @default(false)
  user           User     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model Session {
  id         String    @id @default(uuid())
  user_id    String
  start_time DateTime  @default(now()) @db.Timestamptz(6)
  end_time   DateTime? @db.Timestamptz(6)
  notes      String?
  updated_at DateTime  @default(now()) @db.Timestamptz(6)
  is_deleted Boolean   @default(false)
  cycle      Cycle[]
  user       User      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model Cycle {
  id           String     @id @default(uuid())
  session_id   String
  cycle_number Int
  updated_at   DateTime   @default(now()) @db.Timestamptz(6)
  is_deleted   Boolean    @default(false)
  session      Session    @relation(fields: [session_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  exercise     Exercise[]
}

model Exercise {
  id             String   @id @default(uuid())
  cycle_id       String
  sport_id       String
  value          Int
  order_in_cycle Int
  updated_at     DateTime @default(now()) @db.Timestamptz(6)
  is_deleted     Boolean  @default(false)
  cycle          Cycle    @relation(fields: [cycle_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  sport          Sport    @relation(fields: [sport_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model Sport {
  id         String     @id @default(uuid())
  name       String     @unique
  type_id    String
  updated_at DateTime   @default(now()) @db.Timestamptz(6)
  is_deleted Boolean    @default(false)
  exercise   Exercise[]
  sport_type SportType  @relation(fields: [type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model SportType {
  id         String   @id @default(uuid())
  name       String   @unique
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  is_deleted Boolean  @default(false)
  sport      Sport[]
}
